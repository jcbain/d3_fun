<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>diversity</title>

    <!--styles.css-->
    <link rel="stylesheet" type="text/css" href="css/style.css"/>

    <!--D3 json-->
    <script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/topojson.v2.min.js"></script>
  </head>

  <body>
    <script type="text/javascript">

      //Width and height
      var w = 250;
      var h = 250;

      //Establish a dataset
      var dataset = [ 5];

            //Create scales
      var scale = d3.scaleBand()
                     .domain(d3.range(dataset.length))
                     .rangeRound([0, w])
                     .paddingInner(0.05);

      //Create SVG element
      var svg = d3.select("body")
                  .append("svg")
                  .attr("width", w)
                  .attr("height", h);

            //Create bars
      svg.selectAll("rect")
         .data(dataset)
         .enter()
         .append("rect")
         .attr("x", function(d, i) {
            return scale(i);
         })
         .attr("y", function(d,i) {
            return scale(i);
         })
         .attr("width", scale.bandwidth())
         .attr("height", scale.bandwidth())
         .attr("fill", function(d) {
          return "rgb(0, 0, " + Math.round(d * 10) + ")";
         });

            //On click, update with new data
      d3.select("rect")
        .on("click", function() {

          //Add one new value to dataset
          var newNumber = 5; //New number = 5
          dataset.push(newNumber);                //Add new number to array

          //Update scale domains
          scale.domain(d3.range(dataset.length));  //Recalibrate the x scale domain, given the new length of dataset

          //Select…
          var bars = svg.selectAll("rect")      //Select all bars
                        .data(dataset);             //Re-bind data to existing bars, return the 'update' selection
                                //'bars' is now the update selection

          //Enter…
          bars.enter()                //References the enter selection (a subset of the update selection)
              .append("rect")             //Creates a new rect
              .attr("x", w)             //Sets the initial x position of the rect beyond the far right edge of the SVG
              .attr("y", function(d,i) {        //Sets the y value, based on the updated yScale
               return scale(i);
              })
              .attr("width", scale.bandwidth())    //Sets the width value, based on the updated xScale
              .attr("height", scale.bandwidth()) 
              .attr("fill", function(d) {       //Sets the fill value
               return "rgb(0, 0, " + Math.round(d * 10) + ")";
              })
              .merge(bars)              //Merges the enter selection with the update selection
              .transition()             //Initiate a transition on all elements in the update selection (all rects)
              .duration(500)
              .attr("x", function(d, i) {       //Set new x position, based on the updated xScale
                return scale(i);
              })
              .attr("y", function(d, i) {        //Set new y position, based on the updated yScale
                return scale(i);
              })
              .attr("width", scale.bandwidth())    //Set new width value, based on the updated xScale
              .attr("height", scale.bandwidth())
        });


    </script>
  </body>
</html>
